# Maintainer: Fuwn <contact@fuwn.me>

pkgname='nectar'
pkgver=0.1.0
pkgrel=1
pkgdesc='Command-line Honeyfeed Reader'
arch=('any')
url='https://github.com/Fuwn/nectar'
license=('GPL-3.0-only')
depends=('gum' 'curl' 'pup' 'pandoc' 'glow')
makedepends=('ruby' 'rubygems' 'git')
source=('git+https://github.com/Fuwn/nectar.git#branch=main')
sha256sums=('SKIP')

prepare() {
	gem install --user-install bashly
}

pkgver() {
	cd "${srcdir}/${pkgname}"

	echo "$(git rev-list --count HEAD).$(git rev-parse --short HEAD)"
}

build() {
	cd "${srcdir}/${pkgname}"

	bashly generate
}

package() {
	cd "${srcdir}/${pkgname}"

	mkdir -p "${pkgdir}/usr/bin"

	install -m755 nectar "${pkgdir}/usr/bin/${pkgname}"
}
